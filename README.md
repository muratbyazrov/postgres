СУБД - системы управления базами данных;
СУБД не то же самое, что и база данных;
СУБД реализуется как клиент-серверное приложение, где клиент - это наше приложение, DataGrip или `psql`, а сервер - СУБД. Клиент и сервер обычно расположены на разных серверах, а взаимоействие происходит по `TCP/IP`.

Перед всеми командами в psql ставится `\`, например, `\q` - выход из psql
Все команды доступны так: `\?`

---

# Содержание:
- [Установка и настройка](Установка и настройка)
    - [Установка](Установка)
    - [Подключение](Подключение)
    - [Пользователи](Пользователи)
- Создание и модификация базы данных (DDL)
- Наполнение базы данных (DML)
- Выборка данных (SELECT, WHERE, ORDER, LIMIT, DISTINCT, GROUP, HAVING)
- Агрегирующие функции (COUNT)
- Соединения (JOIN, LEFT JOIN)
- Транзакции (уровни изоляции)
- Реляционная алгебра (основы теории множеств)
- Ключи (первичные, внешние)
- Нормализация данных
- Связи (один-к-одному, один-ко-многим, многие-ко-многим)
- Производительность (индексы)

---

# Установка и настройка

## Установка

Способы установки:
- macos: `brew install postgresql`
- ubuntu: `apt install postgresql`
- docker: `docker run --name <name> -e POSTGRES_PASSWORD=<password> -d -p <port>:<port> postgres`

После установки автоматически:
- создается пользователь `postgres`
- создается база данных `postgres` 

---

## Подключение

PostgreSQL поставляется со специальной программой psql - это клиент для PostgreSQL.
Подключение к PostgreSQL всегда выполняется от имени конкретного пользователя и к конкретной базе данных.

Для подключения к базе данных нужно знать:
- имя базы данных `-d` (по умолчанию совпадает с пользаком OS)
- имя сервера `-h` (по умолчанию локальный сервер)
- номер порта сервера `-p` (по умолчанию 5432)
- имя пользователя `-U`, под которым вы хотите подключиться (по умолчанию пользователь OS, например murat)
Пример команды: `psql -h localhost -U postgres` или `sudo -u postgres psql -h localhost` (здесь мы флагом `-u` указали пользователя)

Имя БД, хост, порт и пользака можно задать через переменные окружения `PGDATABASE`, `PGHOST`, `PGPORT`, `PGUSER`.

Невозможно соединиться с СУБД просто так: соединение всегда происходит с конкретной базой данных. 
Так (`psql -h localhost -U postgres`) мы соединимся с базой postgres, так как по умолчанию подключение идет к одноменной с пользователем БД. 
Для подключения к БД от нового пользователя надо указывать базу флагом `-d`

Создать базу данных: `createdb <name>`
Удалить базу данных: `dropdb <name>`

---

## Пользователи

В старых версиях postgres исользовалось понятие пользователь и группа пользователей. Теперь оперируют понятием *Роль*. Роль и пользователь - это одно и то же.

Пользователь `postgres` имеет максимальные права. Предпочтительнее не работать под этим пользователем.

Создать новую роль:
`sudo -u postgres createuser --createdb murat -h localhost`
 - Флаг `--createdb` добавляет нашей роли возможность создавать базы данных. По умолчанию этой возможности нет
 - Флаг `-h` указывает хост, на котором вертится postgres

Удалить пользоваталя: `dropuser murat`
Посмотреть всех пользователей: `\du`;
Подробнее на [postgres pro](https://postgrespro.ru/docs/postgresql/11/app-createuser)

---
