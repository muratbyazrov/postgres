[Содержание](README.md)

# constraints

[ОГРАНИЧЕНИЯ](https://ru.hexlet.io/courses/rdb-basics/lessons/constraints/theory_unit)

### Первичный ключ
- Первичный ключ однозначно идентифицирует каждую запись внутри таблицы. Задаётся с помощью фразы `PRIMARY KEY`
- `PRIMARY KEY` и `UNIQUE NOT NULL` - это одно и то же
- При добавлении первичного ключа автоматически создаётся уникальный индекс-B-дерево для столбца или группы столбцов, перечисленных в первичном ключе, и данные столбцы помечаются как NOT NULL

Таблица может иметь максимум один первичный ключ.
Ограничений уникальности и ограничений NOT NULL, которые функционально почти равнозначны первичным ключам, может быть сколько угодно, но назначить ограничением первичного ключа можно только одно.
Теория реляционных баз данных говорит, что первичный ключ должен быть в каждой таблице. В Postgres Pro такого жёсткого требования нет, но обычно лучше ему следовать.


Посмотреть все ограничения
`select * from information_schema.table_constraints;`

Разница между CONSTRAINT UNIQUE и UNIQUE INDEX (ограничением уникальности и уникальным индексом) не существенна. При создании уникального ограничения
автоматически создается индекс уникальности. Ограничение уникальности под капотом юзает индекс уникальности. Ощутимая разница будет в тексте ошибки.


### Внешний ключ
Внешний ключ - это ограничение, которое связывает указанную колонку с данными из другой таблицы.
Такое ограничение гарантирует целостность данных. 
То есть попытка удалить данные, у которых есть зависимые данные, приведёт к ошибке.

```SQL
---Быстрый пример 
CREATE TABLE orders (
    id bigint PRIMARY KEY,
    product_id bigint REFERENCES products (id),
    quantity integer
);

--- Каскадное удалением
CREATE TABLE orders (
    product_id bigint REFERENCES products (id) ON DELETE CASCADE,
);
```

### Not null

```SQL
CREATE TABLE products (
    id bigint PRIMARY KEY,
    name text NOT NULL,
    price numeric
);
```

---
[Содержание](README.md)
